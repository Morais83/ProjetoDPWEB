<!DOCTYPE html>
<html lang="pt-pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Polyglot Play</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

  <header class="topbar">
    <a href="../index.html" class="logo-section">
      <img src="../imgs/logo.png" alt="Logo Polyglot Play">
      <h1>Polyglot Play</h1>
    </a>
    <div>
      <a href="../login.html" class="btn">Login</a>
    </div>
  </header>

  <main class="quiz">
    <div class="quiz-card">
      <h1>QUIZZ 1 – Espanhol (A1)</h1>
      <p class="lead">Responde às 5 questões. No fim, clica em <strong>Verificar</strong> para veres a pontuação.</p>

      <form id="quiz" novalidate>
        <fieldset data-q="1" data-correct="a">
          <div class="q-title">1) “Buenos días” significa:</div>
          <div class="options">
            <label class="opt"><input type="radio" name="q1" value="a">a) Bom dia</label>
            <label class="opt"><input type="radio" name="q1" value="b">b) Boa tarde</label>
            <label class="opt"><input type="radio" name="q1" value="c">c) Boa noite</label>
            <label class="opt"><input type="radio" name="q1" value="d">d) Adeus</label>
          </div>
          <div class="feedback" hidden></div>
        </fieldset>

        <fieldset data-q="2" data-correct="b">
          <div class="q-title">2) Completar a frase: <em>Yo ___ un estudiante.</em></div>
          <div class="options">
            <label class="opt"><input type="radio" name="q2" value="a">a) eres</label>
            <label class="opt"><input type="radio" name="q2" value="b">b) soy</label>
            <label class="opt"><input type="radio" name="q2" value="c">c) es</label>
            <label class="opt"><input type="radio" name="q2" value="d">d) está</label>
          </div>
          <div class="feedback" hidden></div>
        </fieldset>

        <fieldset data-q="3" data-answer-text="como estas">
          <div class="q-title">3) Traduzir para espanhol: <em>“Como estás?”</em></div>
          <div class="inline">
            <input type="text" name="q3" placeholder="Escreve aqui a tradução">
          </div>
          <div class="feedback" hidden></div>
        </fieldset>

        <fieldset data-q="4" data-correct="a">
          <div class="q-title">4) “Gracias” quer dizer:</div>
          <div class="options">
            <label class="opt"><input type="radio" name="q4" value="a">a) Obrigado</label>
            <label class="opt"><input type="radio" name="q4" value="b">b) Por favor</label>
            <label class="opt"><input type="radio" name="q4" value="c">c) Desculpa</label>
            <label class="opt"><input type="radio" name="q4" value="d">d) Olá</label>
          </div>
          <div class="feedback" hidden></div>
        </fieldset>

        <fieldset data-q="5" data-correct="a">
          <div class="q-title">5) Completar a frase: <em>Ella ___ un gato.</em></div>
          <div class="options">
            <label class="opt"><input type="radio" name="q5" value="a">a) tiene</label>
            <label class="opt"><input type="radio" name="q5" value="b">b) tengo</label>
            <label class="opt"><input type="radio" name="q5" value="c">c) tener</label>
            <label class="opt"><input type="radio" name="q5" value="d">d) tienes</label>
          </div>
          <div class="feedback" hidden></div>
        </fieldset>

        <div class="actions">
          <button type="submit" class="primary">Verificar</button>
          <button type="button" id="limpar">Limpar</button>
        </div>

        <div id="result" class="result" aria-live="polite"></div>
      </form>
    </div>
  </main>

  <script>
  (function(){
    const form = document.getElementById('quiz');
    const result = document.getElementById('result');

    const clean = s => s
      .toLowerCase().trim()
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'')     
      .replace(/[¿?¡!.,;:()/[\]{}"]/g,' ')                 
      .replace(/\s+/g,' ');                                

    const showFeedback = (el, ok, msg) => {
      const fb = el.querySelector('.feedback');
      fb.hidden = false;
      fb.innerHTML = msg;
      fb.className = 'feedback ' + (ok ? 'ok' : 'ko');
    };

    form.addEventListener('submit', function(e){
      e.preventDefault();
      let score = 0, total = 5;

      [1,2,4,5].forEach(n=>{
        const fs = form.querySelector('fieldset[data-q="'+n+'"]');
        const correct = fs.dataset.correct;
        const checked = form.querySelector('input[name="q'+n+'"]:checked');
        const isOk = checked && checked.value === correct;
        if(isOk) score++;
        showFeedback(fs, !!isOk,
          isOk ? '✔ Boa!' : '✘ Resposta certa: <strong>'+correct.toUpperCase()+')</strong>');
      });

      const fs3 = form.querySelector('fieldset[data-q="3"]');
      const rightText = fs3.dataset.answerText;
      const typed = clean(form.q3.value||'');
      const isOk3 = typed === rightText;
      if(isOk3) score++;
      showFeedback(fs3, isOk3,
        isOk3 ? '✔ Correto!' : '✘ Resposta certa: <strong>¿Cómo estás?</strong>');

      result.textContent = 'Pontuação: ' + score + '/' + total + (score===total?' • Excelente!':'');
    });

    document.getElementById('limpar').addEventListener('click', ()=>{
      form.reset();
      document.querySelectorAll('.feedback').forEach(f=>{f.hidden=true;f.textContent='';f.className='feedback';});
      document.querySelectorAll('.badge').forEach(b=>b.remove());
      result.textContent = '';
    });
  })();
  </script>

</body>
</html>